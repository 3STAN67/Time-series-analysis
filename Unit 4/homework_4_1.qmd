---
title: "Time Series Homework: Chapter 4 Lesson 1"
subtitle: "Tristan Farrow"
format: 
  html:
    embed-resources: true
    toc: true
---

```{r, echo=FALSE, message=FALSE, warning=FALSE}

# Loading R packages
if (!require("pacman")) install.packages("pacman")
pacman::p_load(tidyverse, 
               tsibble, fable,
               feasts, tsibbledata,
               fable.prophet,
               patchwork,
               lubridate, 
               rio,
               ggplot2,
               kableExtra
               )
```

## Questions

### Question 1 - Gaussian White Noise (30 points)

#### a) Simulate a realization of Gaussian White Noise and plot it. Use 50 points and $\sigma^2=2$

::: {.callout-note title="Answer" icon="false"}
```{r}

n <- 50           # number of points
sigma2 <- 2       # variance
sigma <- sqrt(sigma2)  # standard deviation

# Set seed for reproducibility (optional)
set.seed(42)

# Simulate Gaussian White Noise
gwn <- rnorm(n, mean = 0, sd = sigma)

# Time Series Plot
plot(gwn, type = "l", main = "White Noise Time Series")

```
:::

#### b) Estimate the second order properties of the sample. Why don't they match exactly with the parameters values you used to create it?

::: {.callout-note title="Answer" icon="false"}
```{r}
cat("Mean:", mean(gwn), "\n")

acf(gwn, type = "covariance",plot = FALSE)

acf(gwn, main = "Autocorrelation Function")

```

<!-- Delete this and put your answer here. The three colons mark the end of your answer. -->
:::

#### c) Use the classical decomposition on your simulated series, plot the results.

::: {.callout-note title="Answer" icon="false"}
```{r}
#| warning: false

data_ts <- tsibble(
  time = yearmonth(seq(as.Date("2020-01-01"), by = "month", length.out = 50)),
  gwn = gwn,
  index = time
)

decomp <- data_ts %>% 
  model(feasts::classical_decomposition(gwn, type = 'add')) %>% 
  components()

decomp

autoplot(decomp)


```
:::

#### d) Please evaluate the estimates of the trend and seasonal component.

::: {.callout-note title="Answer" icon="false"}
```{r}



```

The estimates for the trend and seasonal component appear to be chaotic and messy. This is to be expected for white noise because it is random.
:::

### Question 3 - Random Walks (55 points)

#### a) Simulate a realization of a white noise process using the Exponential distribution. If $s_t$ is the realization from an exponentially distributed random variable, use the white noise $w_t=s_t-\lambda$ for your simulation. The length of the series is 500 points and $\lambda=1$. Please plot your simulation.

::: {.callout-note title="Answer" icon="false"}
```{r}

# Parameters
n <- 500
lambda <- 1

# Simulate exponentially distrubuted random variable 
set.seed(123)
s_t <- rexp(n, rate = lambda)

# Create while noise
w_t <- s_t - lambda

plot(w_t, type = "l",
     main = "White Noise from Exponential Distribution",
     xlab = "Time",
     ylab = expression(w[t]),
     col = "blue")

```
:::

#### b) Superimpose a histogram of the Gaussian White noise simulation from Question 2 versus the Exponential White Noise. Please compare and contrast the two distributions. Your chart should look close to Figure 1 below. *Hint: research exponential random variables and their right-tail properties.*

```         
![Figure 1](https://github.com/byuistats/timeseries/raw/master/images/Overlayed_Histograms_HW4_1.png)
```

::: {.callout-note title="Answer" icon="false"}
```{r}

hist(gwn,
     col = rgb(0,0,1,0.5),
     probability = TRUE,
     xlim = c(-5,5),
     ylim = c(0,0.5),
     main = "Gaussian Vs Exponential White Noise",
     xlab = "Value",
     ylab = "Density")

hist(w_t,
     breaks = 30,
     col = rgb(1,0,0,0.5),
     probabilty = TRUE,
     add = TRUE)

```
:::

#### c) Create a random walk series using the Exponential DWN simulations. Please plot the series.

::: {.callout-note title="Answer" icon="false"}
```{r}
# Set parameters
n <- 500
lambda <- 1

# Simulate Exponential White Noise
set.seed(123)
s_t <- rexp(n, rate = lambda)
exp_wn <- s_t - lambda

# Create Random Walk: X_t = X_{t-1} + w_t
# Starting value X_0 = 0
random_walk <- cumsum(exp_wn)

# Plot the random walk
plot(random_walk, type = "l", 
     main = "Random Walk with Exponential White Noise",
     xlab = "Time",
     ylab = expression(X[t]),
     col = "blue",
     lwd = 1.5)
abline(h = 0, col = "red", lty = 2)
grid()
```
:::

#### d) Use the Holt-Winters decomposition method to estimate the trend, seasonal, and random components of the series.

::: {.callout-note title="Answer" icon="false"}
```{r}

# Generate the data
set.seed(123)
n <- 500
lambda <- 1
s_t <- rexp(n, rate = lambda)
exp_wn <- s_t - lambda
random_walk <- cumsum(exp_wn)

# Create a tsibble (not ts) for fable
ts_data <- tsibble(
  time = yearmonth(seq(as.Date("2020-01-01"), by = "month", length.out = n)),
  random_walk = random_walk,
  index = time
)

# Fit Holt-Winters model
hw_data <- ts_data %>% 
  model(Additive = ETS(random_walk ~ error("A") + trend("A", alpha = 0.2, beta = 0.1) + season("A", gamma = 0.1)))

# View the model
report(hw_data)

```
:::

#### e) Please evaluate the estimates for the parameters of the model using the default algorithm settings (minimize the SS1PE).

::: {.callout-note title="Answer" icon="false"}
```{r}
# Fit Holt-Winters model
hw_data_SS1PE <- ts_data %>% 
  model(Additive = ETS(random_walk ~ error("A") + trend("A") + season("A")))

# View the model
report(hw_data_SS1PE)
```
:::

### Rubric

+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
|                                                        | **Mastery (5)**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | **Incomplete (0)**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |        |
+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
| **Question 1a: Gaussian White Noise**                  | They effectively plot the simulated realization of Gaussian White Noise in R using plotting functions like plot() or ggplot2, ensuring proper labeling of the axes, a title, and any other necessary elements for clear visualization. Code is well-commented.                                                                                                                                                                                                                                                                                                                                         | Students struggle to simulate Gaussian White Noise in R or effectively plot the simulation, potentially due to errors in coding or misunderstandings of the process. Their R code may lack sufficient comments, making it challenging for others to understand or reproduce the results. The plot may lack clarity or proper presentation, hindering interpretation, and may omit necessary elements such as axis labels or a title.                                                                                                                                                                                                      |        |
+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
|                                                        | **Mastery (10)**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | **Incomplete (0)**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |        |
+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
| **Question 1b: Sample second order properties**        | Students demonstrate an understanding of statistical concepts such as variance, covariance, and autocorrelation, and use appropriate methods or functions to estimate these properties in their chosen statistical software. Proficient explanations may highlight factors such as sample size, random variability, or measurement error, which can introduce discrepancies between estimated properties and the parameters set during data creation.                                                                                                                                                  | Students fail to estimate the second-order properties of the sample data or provide a coherent explanation for discrepancies with the parameters set during data creation. They may demonstrate a limited understanding of statistical concepts or use inappropriate methods for estimation. Additionally, they may overlook key factors contributing to discrepancies, providing vague or incomplete explanations. Overall, their analysis may lack depth or clarity, hindering comprehension of the reasons behind the observed differences.                                                                                            |        |
+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
|                                                        | **Mastery (5)**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | **Incomplete (0)**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |        |
+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
| **Question 1c: Decomposition**                         | Student applies the classical decomposition to the simulated series, accurately separating and plotting the components (trend, seasonal, and random) with clear labels and appropriate formatting. \| Fails to apply classical decomposition or does not plot the decomposed components clearly. Missing labels or poor formatting make the plot difficult to interpret.                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |        |
+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
|                                                        | **Mastery (10)**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | **Incomplete (0)**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |        |
+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
| **Question 1d: Interpretation and Analysis**           | Clearly evaluates the trend and seasonal component estimates. Provides a well-reasoned evaluation of whether decomposition is appropriate for the series.                                                                                                                                                                                                                                                                                                                                                                                                                                              | Fails to accurately interpret the trend and seasonal components, providing minimal or incorrect insights into the data patterns. Lacks a clear or well-supported evaluation of the appropriateness of decomposition, with reasoning that is vague, unsupported, or does not address the model assumptions.                                                                                                                                                                                                                                                                                                                                |        |
+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
|                                                        | **Mastery (10)**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | **Incomplete (0)**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |        |
+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
| **Question 2a: Simulation and Plot**                   | Correctly simulates a realization of white noise by generating 500 points from an Exponential distribution, and presents the results in a clear plot with appropriate axis labels and units.                                                                                                                                                                                                                                                                                                                                                                                                           | Fails to correctly simulate the white noise process, does not use the specified parameters, or presents a plot that lacks clarity, labels, or units.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |        |
+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
|                                                        | **Mastery (10)**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | **Incomplete (0)**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |        |
+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
| **Question 2b: Histograms**                            | Responses superimpose a histogram of the Gaussian White Noise simulation from Question 2 alongside the Exponential White Noise. They compare and contrast the two distributions, demonstrating an understanding of statistical concepts such as mean and variance. Proficient analyses may include research findings on the mean and variance of an exponential random variable, providing context for the comparison. The resulting chart closely resembles Figure 1, showing clear distinctions between the distributions and offering insightful commentary on their similarities and differences.\ | Responses may struggle to accurately superimpose the histograms of Gaussian White Noise and Exponential White Noise or provide a coherent comparison between the two distributions. They may lack understanding of statistical concepts such as mean and variance or fail to research the properties of an exponential random variable. The resulting chart may lack clarity or proper presentation, hindering interpretation of the distributions. Additionally, they may overlook key differences between the distributions or provide vague or superficial comparisons, indicating a limited understanding of the underlying concepts. |        |
+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
|                                                        | **Mastery (10)**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | **Incomplete (0)**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |        |
+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
| **Question 2c: Simulate a Random Walk**                | Correctly generates a random walk series using Exponential DWN simulations and accurately plots the series with clear axis labels and units                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Fails to correctly generate the random walk series, does not use Exponential DWN as specified, or presents a plot that lacks clarity, labels, or appropriate units.                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |        |
+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
|                                                        | **Mastery (5)**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | **Incomplete (0)**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |        |
+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
| **Question 2d: Holt Winters Decomposition**            | Applies the Holt-Winters decomposition method to estimate the trend, seasonal, and random components, presenting results that clearly reflect each component’s behavior within the series.                                                                                                                                                                                                                                                                                                                                                                                                             | Fails to apply the Holt-Winters decomposition, produces inaccurate component estimates, or presents results that are unclear or incorrectly labeled.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |        |
+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
|                                                        | **Mastery (20)**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | **Incomplete (0)**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |        |
+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
| **Question 2e: Holt Winters Decomposition Evaluation** | Provides a thoughtful evaluation of whether decomposition is appropriate for a random walk, considering the characteristics of the series.                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Fails to interpret the parameter estimates or provides an incomplete or incorrect explanation of their significance. Does not evaluate decomposition validity for a random walk or provides unsupported reasoning.                                                                                                                                                                                                                                                                                                                                                                                                                        |        |
+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
| **Total Points**                                       | **85**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |        |
+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+
